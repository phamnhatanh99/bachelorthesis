<!DOCTYPE html>
<html lang="en" xmlns:th="https://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Register a dataset</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
</head>
<body>
    <h1 class="text-center pt-2">Dataset registration</h1>
    <div class="container">
        <form action="#" th:action="@{/register}" th:object="${metadata_form}" id="metadata-form" enctype="multipart/form-data" method="post">
            <div class="mb-3">
                <label class="form-label" for="csv">Upload dataset</label>
                <input type="file" class="form-control" id="csv" accept=".csv" name="file" th:field="*{file}">
            </div>
            <div class="mb-3">
                <label class="form-label" for="col-1">Column 1's type</label>
                <select id="col-1" class="form-select" th:field="*{columnsTypes[0]}">
                    <optgroup label="String">
                        <option value="text" selected>Text</option>
                    </optgroup>
                    <optgroup label="Numeric">
                        <option value="boolean">Boolean</option>
                        <option value="integer">Integer</option>
                        <option value="double">Double</option>
                    </optgroup>
                    <optgroup label="Temporal">
                        <option value="date">Date</option>
                        <option value="datetime">Date and Time</option>
                        <option value="Time">Time</option>
                    </optgroup>
                </select>
            </div>
            <div class="mb-3" id="add-button-class">
                <button id="add-field" class="btn btn-secondary btn-sm" type="button">Add Field</button>
                <button id="delete-field" class="btn btn-secondary btn-sm" type="button">Delete Field</button>
            </div>
            <div class="mb-3">
                <button type="submit" class="btn btn-primary">Submit</button>
            </div>
        </form>
    </div>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            let counter = 1;
            const addButton = document.getElementById('add-field');
            const addButtonClass = document.getElementById('add-button-class');
            const form = document.getElementById('metadata-form');
            const deleteButton = document.getElementById('delete-field');
            addButton.addEventListener('click', function() {
                counter++;
                const newField = document.createElement('div');
                newField.className = 'mb-3';
                newField.innerHTML = `
                <label class="form-label" for="col-${counter}">Column ${counter}'s type</label>
                <select class="form-select" id="col-${counter}" name="columnsTypes[${counter - 1}]">
                    <optgroup label="String">
                        <option value="text" selected>Text</option>
                    </optgroup>
                    <optgroup label="Numeric">
                        <option value="boolean">Boolean</option>
                        <option value="integer">Integer</option>
                        <option value="double">Double</option>
                    </optgroup>
                    <optgroup label="Temporal">
                        <option value="date">Date</option>
                        <option value="datetime">Date and Time</option>
                        <option value="Time">Time</option>
                    </optgroup>
                </select>
            `;
                form.insertBefore(newField, addButtonClass);
            });
            deleteButton.addEventListener('click', function() {
                if (counter > 1) {
                    counter--;
                    form.removeChild(form.children[form.children.length - 3]);
                }
            });
        });
    </script>
</body>
</html>